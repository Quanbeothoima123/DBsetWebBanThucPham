
@{
    ViewData["Title"] = "Trang chủ";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<!-- Begin Slider Area -->
<style>
    .hidden-product {
        display: none;
    }
</style>

<div class="slider-area">

    <!-- Main Slider -->
    <div class="swiper-container main-slider swiper-arrow with-bg_white">
        <div class="swiper-wrapper">
            <div class="swiper-slide animation-style-01">
                <div class="slide-inner bg-height" data-bg-image="~/assets/images/slider/bg/1-1.jpg">
                    <div class="parallax-img-wrap">
                        <div class="chilly">
                            <div class="scene fill">
                                <div class="expand-width" data-depth="0.2">
                                    <img src="~/assets/images/slider/inner-img/1-1-231x210.png" alt="Inner Image">
                                </div>
                            </div>
                        </div>
                        <div class="avocado">
                            <div class="scene fill">
                                <div class="expand-width" data-depth="0.5">
                                    <img src="~/assets/images/slider/inner-img/1-2-224x204.png" alt="Inner Image">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="container">
                        <div class="parallax-with-content">
                            <div class="slide-content">
                                <span class="sub-title mb-3">Sản phẩm tự nhiên  & Hữu cơ</span>
                                <h2 class="title mb-9">Giảm đến 40%</h2>
                                <div class="button-wrap">
                                    <a class="btn btn-custom-size lg-size btn-primary btn-white-hover rounded-0" asp-controller="Product" asp-action="Index">Mua ngay thôi!</a>
                                </div>
                            </div>
                            <div class="parallax-img-wrap">
                                <div class="tomatoes">
                                    <div class="scene fill">
                                        <div class="expand-width" data-depth="0.5">
                                            <img src="~/assets/images/slider/inner-img/1-3-601x534.png" alt="Inner Image">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="swiper-slide animation-style-01">
                <div class="slide-inner bg-height" data-bg-image="~/assets/images/slider/bg/1-1.jpg">
                    <div class="parallax-img-wrap">
                        <div class="chilly">
                            <div class="scene fill">
                                <div class="expand-width" data-depth="0.2">
                                    <img src="~/assets/images/slider/inner-img/1-1-231x210.png" alt="Inner Image">
                                </div>
                            </div>
                        </div>
                        <div class="avocado">
                            <div class="scene fill">
                                <div class="expand-width" data-depth="0.5">
                                    <img src="~/assets/images/slider/inner-img/1-2-224x204.png" alt="Inner Image">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="container">
                        <div class="parallax-with-content">
                            <div class="slide-content">
                                <span class="sub-title mb-3">Sản phẩm tự nhiên  & Hữu cơ</span>
                                <h2 class="title mb-9">Giảm đến 40%<br> Products.</h2>
                                <div class="button-wrap">
                                    <a class="btn btn-custom-size lg-size btn-primary btn-white-hover rounded-0" asp-controller="Product" asp-action="Index">Mua ngay thôi!</a>
                                </div>
                            </div>
                            <div class="parallax-img-wrap">
                                <div class="tomatoes">
                                    <div class="scene fill">
                                        <div class="expand-width" data-depth="0.5">
                                            <img src="~/assets/images/slider/inner-img/2-1-601x426.png" alt="Inner Image">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Add Pagination -->
        <div class="swiper-pagination with-bg d-md-none"></div>

        <!-- Add Arrows -->
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

</div>
<!-- Slider Area End Here -->
<!-- Begin Shipping Area -->
<div class="shipping-area section-space-top-100">
    <div class="container">
        <div class="row">
            <div class="col-lg-4 col-md-6">
                <div class="shipping-item">
                    <div class="shipping-img">
                        <img src="~/assets/images/shipping/icon/plane.png" alt="Shipping Icon">
                    </div>
                    <div class="shipping-content">
                        <h5 class="title">Miễn phí vận chuyển</h5>
                        <p class="short-desc mb-0">Miễn phí giao hàng tận nhà</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-6 pt-6 pt-md-0">
                <div class="shipping-item">
                    <div class="shipping-img">
                        <img src="~/assets/images/shipping/icon/earphones.png" alt="Shipping Icon">
                    </div>
                    <div class="shipping-content">
                        <h5 class="title">Hỗ trợ trực tuyến</h5>
                        <p class="short-desc mb-0">Dịch vụ hỗ trợ 24/7</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-6 pt-6 pt-lg-0">
                <div class="shipping-item">
                    <div class="shipping-img">
                        <img src="~/assets/images/shipping/icon/shield.png" alt="Shipping Icon">
                    </div>
                    <div class="shipping-content">
                        <h5 class="title">Thanh toán bảo mật</h5>
                        <p class="short-desc mb-0">Hệ thống thanh toán bảo mật</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Shipping Area End Here -->
<!-- Begin Product Area -->
<div class="product-area section-space-top-100">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <ul class="nav product-tab-nav pb-10" id="myTab" role="tablist">
                    @foreach (var category in ViewBag.Categories)
                    {
                        <li class="nav-item" role="presentation">
                            <a class="nav-link @(category.CatId == 1 ? "active" : "")"
                               id="tab-@category.CatId"
                               data-bs-toggle="tab"
                               href="#category-@category.CatId"
                               role="tab"
                               aria-controls="category-@category.CatId"
                               aria-selected="@(category.CatId == 1 ? "true" : "false")">
                                <div class="product-tab-icon">
                                    <img src="@string.Format("/assets/images/product/icon/{0}.png", category.CatId)" alt="@category.CatName">
                                </div>
                                @category.CatName
                            </a>
                        </li>
                    }
                </ul>
                <div class="tab-content" id="myTabContent">
                    @foreach (var category in ViewBag.Categories)
                    {
                        var products = ViewBag.ProductsByCategory[category.CatId] as List<Product>;

                        <div class="tab-pane fade @(category.CatId == 1 ? "show active" : "")"
                             id="category-@category.CatId"
                             role="tabpanel"
                             aria-labelledby="tab-@category.CatId">

                            <div class="product-item-wrap row">
                                @if (products != null && products.Any())
                                {
                                    @for (int i = 0; i < products.Count; i++)
                                    {
                                        var product = products[i];

                                        <div class="col-xl-4 col-lg-4 col-sm-6 pt-6 pt-xl-0 product-item @(i >= 6 ? "hidden-product d-none" : "")" data-index="@i">
                                            <div class="product-box">
                                                <div class="product-img img-zoom-effect">
                                                    <a asp-controller="Product" asp-action="Details" asp-route-id="@product.ProductId">
                                                        <img class="img-full" src="@product.Thumb" alt="@product.ProductName">
                                                    </a>
                                                    <div class="product-add-action">
                                                        <ul>
                                                            <li>
                                                                <a asp-controller="Cart"
                                                                   asp-action="AddToCart"
                                                                   asp-route-productId="@product.ProductId"
                                                                   title="Thêm vào giỏ">
                                                                    <i class="pe-7s-cart"></i>
                                                                </a>
                                                            </li>                               
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="product-content">
                                                    <a class="product-name" asp-controller="Product" asp-action="Details" asp-route-id="@product.ProductId">@product.ProductName</a>
                                                    <div class="price-box pb-1">
                                                        <span class="new-price">$@product.Price</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    }

                                    <!-- Nút "Xem thêm" -->
                                    @if (products.Count > 6)
                                    {
                                        <div class="col-12 text-center">
                                            <button class="btn btn-primary mt-4 btn-show-more" data-category="@category.CatId">Xem thêm</button>
                                        </div>
                                    }
                                }
                                else
                                {
                                    <p>Không có sản phẩm nào trong danh mục này.</p>
                                }
                            </div>
                        </div>
                    }
                </div>

            </div>
        </div>
    </div>
</div>

<div class="blog-area section-space-y-axis-100">
    <div class="container">
        <div class="section-title text-center pb-55">
            <span class="sub-title text-primary">Xem bài viết của chúng tôi </span>
            <h2 class="title mb-0">Tin tức</h2>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="swiper-container blog-slider">
                    <div class="swiper-wrapper">
                        @if (ViewBag.NewfeedPosts != null)
                        {
                            @foreach (var post in ViewBag.NewfeedPosts)
                            {
                                <div class="swiper-slide">
                                    <div class="blog-item">
                                        <div class="blog-img img-zoom-effect">
                                            <a href="@Url.Action("Detail", "Blog", new { id = post.PostId })">
                                                <img class="img-full" src="@post.Thum" alt="@post.Title">
                                            </a>
                                        </div>
                                        <div class="blog-content">
                                            <div class="blog-meta text-dim-gray pb-3">
                                                <ul>
                                                    <li class="date">
                                                        <i class="fa fa-calendar-o me-2"></i>
                                                        @post.CreatedDate?.ToString("MMM dd, yyyy")
                                                    </li>
                                                </ul>
                                            </div>
                                            <h5 class="title mb-4">
                                                <a href="@Url.Action("Detail", "Blog", new { id = post.PostId })">@post.Title</a>
                                            </h5>
                                            <p class="short-desc mb-5">@post.Scontents</p>
                                            <div class="button-wrap">
                                                <a class="btn btn-custom-size btn-dark btn-lg rounded-0" href="@Url.Action("Detail", "Blog", new { id = post.PostId })">Đọc thêm</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                        }
                    </div>

                    <!-- Add Arrows -->
                    <div class="swiper-button-next"></div>
                    <div class="swiper-button-prev"></div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Blog Area End Here -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll(".btn-show-more").forEach(button => {
            button.addEventListener("click", function () {
                let categoryId = this.getAttribute("data-category");
                let hiddenProducts = document.querySelectorAll(`#category-${categoryId} .hidden-product`);

                let count = 0;
                hiddenProducts.forEach(product => {
                    if (count < 6) {
                        product.classList.remove("hidden-product", "d-none");
                        count++;
                    }
                });

                // Nếu không còn sản phẩm nào ẩn, ẩn luôn nút "Xem thêm"
                if (document.querySelectorAll(`#category-${categoryId} .hidden-product`).length === 0) {
                    this.style.display = "none";
                }
            });
        });
    });

</script>


